<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Life Dashboard</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",system-ui,Segoe UI,Roboto,Arial,sans-serif}

    /* ===== Relaxed background ===== */
    body{
      height:100vh;overflow:hidden;
      background:linear-gradient(-45deg,#a1c4fd,#c2e9fb,#fbc2eb,#fad0c4);
      background-size:400% 400%;animation:grad 24s ease infinite;
    }
    @keyframes grad{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    .bubbles span{
      position:absolute;bottom:-60px;border-radius:50%;
      background:rgba(255,255,255,.28);filter:blur(.2px);
      animation:rise linear infinite;
    }
    @keyframes rise{to{transform:translateY(-120vh) scale(.6);opacity:.7}}
    /* varied sizes & timings via inline style */

    /* ===== Welcome Overlay ===== */
    #welcome{
      position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;
      background:rgba(0,0,0,.55);color:#fff;z-index:10;animation:fadeIn 1.4s ease;
      text-align:center;padding:24px;
    }
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    #welcome h1{
      font-size:28px;white-space:nowrap;overflow:hidden;border-right:3px solid #fff;width:0ch;
      animation:typing 3.2s steps(32,end) forwards, caretBlink .7s step-end infinite alternate;
    }
    @keyframes typing{from{width:0ch}to{width:32ch}}
    @keyframes caretBlink{50%{border-color:transparent}}
    #welcome p{margin-top:14px;opacity:.85;animation:pulse 2.2s ease-in-out infinite}
    @keyframes pulse{0%,100%{opacity:.55}50%{opacity:1}}

    /* ===== Dashboard ===== */
    .dashboard{
      display:none;
      width:92%;max-width:1180px;height:90vh;margin:5vh auto;padding:20px;overflow-y:auto;
      background:rgba(255,255,255,.22);backdrop-filter:blur(18px);
      border-radius:22px;box-shadow:0 10px 30px rgba(0,0,0,.15);
      display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;
      animation:zoomIn 1s ease;
    }
    @keyframes zoomIn{from{opacity:0;transform:scale(.94)}to{opacity:1;transform:scale(1)}}

    .card{
      background:rgba(255,255,255,.28);border-radius:16px;padding:18px;
      box-shadow:0 6px 20px rgba(0,0,0,.12);color:#233;
      animation:cardIn .8s ease;
    }
    @keyframes cardIn{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
    .card h2{font-size:18px;margin-bottom:12px;color:#123}
    input,textarea{
      width:100%;border:none;outline:none;border-radius:12px;padding:12px;font-size:14px;
      background:rgba(255,255,255,.9)
    }
    textarea{min-height:96px;resize:vertical}
    .hint{font-style:italic;color:#6a7a85;margin:2px 0 8px}
    button{
      margin-top:10px;padding:10px 14px;border:none;border-radius:12px;cursor:pointer;
      background:linear-gradient(45deg,#fbc2eb,#a6c1ee);color:#233;font-weight:600;
      transition:.25s;box-shadow:0 4px 12px rgba(0,0,0,.08)
    }
    button:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.12)}

    /* ===== Voice listening ===== */
    .listening{margin-top:8px;font-weight:700;color:#223;display:none}
    .dots span{animation:dots 1.4s infinite}
    .dots span:nth-child(2){animation-delay:.2s}
    .dots span:nth-child(3){animation-delay:.4s}
    @keyframes dots{0%{opacity:0}50%{opacity:1}100%{opacity:0}}

    .mood{font-size:30px;margin-left:6px}

    /* ===== Pomodoro timer ===== */
    .timer-circle{
      width:130px;height:130px;margin:6px auto 10px;border-radius:50%;
      border:6px solid rgba(255,255,255,.45);display:flex;align-items:center;justify-content:center;
      position:relative;font-weight:700
    }
    .progress{position:absolute;inset:0;border-radius:50%;border:6px solid #6a11cb;
      clip:rect(0,130px,130px,65px);transform:rotate(0deg);transition:transform 1s linear}

    /* ===== Daily Motivation (fade) ===== */
    #quote{opacity:0;text-align:left;animation:fadeQuote 7s ease-in-out infinite}
    @keyframes fadeQuote{0%,100%{opacity:0}20%,80%{opacity:1}}

    /* ===== Calendar ===== */
    .calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;margin-top:10px}
    .day{
      background:rgba(255,255,255,.6);border-radius:10px;min-height:58px;padding:6px;
      text-align:center;font-size:12px;display:flex;flex-direction:column;justify-content:center;gap:2px
    }
    .highlight{background:#fad0c4;font-weight:700}
  </style>
</head>
<body>
  <!-- Floating bubbles for relaxed vibe -->
  <div class="bubbles" aria-hidden="true">
    <span style="left:8%;width:26px;height:26px;animation-duration:28s;animation-delay:0s;"></span>
    <span style="left:22%;width:18px;height:18px;animation-duration:22s;animation-delay:3s;"></span>
    <span style="left:38%;width:34px;height:34px;animation-duration:30s;animation-delay:1s;"></span>
    <span style="left:55%;width:22px;height:22px;animation-duration:24s;animation-delay:2s;"></span>
    <span style="left:72%;width:28px;height:28px;animation-duration:27s;animation-delay:4s;"></span>
    <span style="left:88%;width:16px;height:16px;animation-duration:20s;animation-delay:6s;"></span>
  </div>

  <!-- Welcome -->
  <div id="welcome" onclick="enterDashboard()">
    <h1>Welcome to your Life Dashboard</h1>
    <p>‚ú® Tap to continue ‚ú®</p>
  </div>

  <!-- Dashboard -->
  <div class="dashboard" id="dashboard" role="main" aria-live="polite">
    <!-- Daily Goal -->
    <div class="card">
      <h2>üéØ Daily Focus</h2>
      <input id="dailyGoal" type="text" placeholder="Your main goal today"/>
      <button onclick="saveGoal()">Save</button>
      <p id="savedGoal"></p>
    </div>

    <!-- Mini Journal with the requested prompt -->
    <div class="card">
      <h2>üìì Mini Journal</h2>
      <p class="hint">‚ú® Tell three good things that happened today:</p>
      <textarea id="journalEntry" placeholder="Write here..."></textarea>
      <button onclick="saveJournal()">Save</button>
      <p id="savedJournal" style="margin-top:8px;"></p>
    </div>

    <!-- Voice Mood & Notes -->
    <div class="card">
      <h2>üé§ Voice Mood & Notes</h2>
      <div>
        <button onclick="startListening()">Start Speaking</button>
        <button onclick="stopListening()">Stop Recording</button>
      </div>
      <p class="listening" id="listening">Listening<span class="dots"><span>.</span><span>.</span><span>.</span></span></p>
      <p id="voiceNote" style="margin-top:6px;"></p>
      <p>Detected mood: <span id="emojiMood" class="mood">üôÇ</span></p>
    </div>

    <!-- Pomodoro -->
    <div class="card">
      <h2>‚è≥ Pomodoro Timer</h2>
      <div class="timer-circle">
        <div id="progress" class="progress"></div>
        <span id="timer">25:00</span>
      </div>
      <div>
        <button onclick="startTimer()">Start</button>
        <button onclick="resetTimer()">Reset</button>
      </div>
      <p style="margin-top:8px;">Today's Pomodoros: <span id="pomoCount">0</span></p>
    </div>

    <!-- Motivation -->
    <div class="card">
      <h2>üí° Daily Motivation</h2>
      <p id="quote"></p>
    </div>

    <!-- Calendar -->
    <div class="card">
      <h2>üìÖ Progress Calendar</h2>
      <div class="calendar" id="calendar"></div>
    </div>

    <!-- Daily Voice (quick view) -->
    <div class="card">
      <h2>üóÇ Your Daily Voice Note</h2>
      <p id="savedVoice"></p>
    </div>
  </div>

  <script>
    /* ---------- Helpers ---------- */
    const todayStr = () => new Date().toISOString().split('T')[0];
    const getData = () => JSON.parse(localStorage.getItem("progress") || "{}");
    const setData = (obj) => localStorage.setItem("progress", JSON.stringify(obj));

    /* ---------- Welcome ---------- */
    function enterDashboard(){
      document.getElementById("welcome").style.display="none";
      const dash = document.getElementById("dashboard");
      dash.style.display="grid";
      dash.focus();
    }

    /* ---------- Save Goal ---------- */
    function saveGoal(){
      const goal = document.getElementById("dailyGoal").value.trim();
      const data = getData(), t = todayStr();
      if(!data[t]) data[t] = {};
      data[t].goal = goal;
      setData(data);
      document.getElementById("savedGoal").innerText = goal ? "‚úÖ " + goal : "";
      renderCalendar();
    }

    /* ---------- Mini Journal (with prompt) ---------- */
    function saveJournal(){
      const entry = document.getElementById("journalEntry").value.trim();
      const data = getData(), t = todayStr();
      if(!data[t]) data[t] = {};
      if(entry){
        data[t].journal = entry;
        setData(data);
        document.getElementById("savedJournal").innerText = "‚úÖ Journal saved for today!";
        renderCalendar();
      }else{
        alert("Please write at least one thing üôÇ");
      }
    }

    /* ---------- Voice Recognition + Mood ---------- */
    let recognition;
    const listeningEl = document.getElementById("listening");
    const voiceNoteEl = document.getElementById("voiceNote");
    const emojiEl = document.getElementById("emojiMood");

    if('webkitSpeechRecognition' in window){
      recognition = new webkitSpeechRecognition();
      recognition.lang = "en-US";
      recognition.continuous = false;
      recognition.interimResults = false;

      recognition.onstart = () => listeningEl.style.display = "block";
      recognition.onend   = () => listeningEl.style.display = "none";

      recognition.onresult = (e) => {
        const transcript = e.results[0][0].transcript;
        voiceNoteEl.innerText = "You said: " + transcript;

        const data = getData(), t = todayStr();
        if(!data[t]) data[t] = {};
        data[t].voice = transcript;

        // detect mood from transcript (simple, extensible)
        const text = transcript.toLowerCase();
        let mood = "üòê";
        if(text.match(/happy|good|great|awesome|grateful|fine/)) mood = "üòä";
        else if(text.match(/sad|down|tired|low|bad/))           mood = "üò¥";
        else if(text.match(/angry|mad|frustrated|annoyed/))     mood = "üò°";
        else if(text.match(/excited|energetic|pumped|motivated/)) mood = "üöÄ";
        data[t].mood = mood;

        setData(data);
        emojiEl.textContent = mood;
        document.getElementById("savedVoice").innerText = "Today‚Äôs note: " + transcript;
        renderCalendar();
      };

      recognition.onerror = (e)=> console.warn("Speech error:", e.error);
    }

    function startListening(){
      if(recognition){ recognition.start(); }
      else{ alert("Speech Recognition not supported in this browser."); }
    }
    function stopListening(){
      if(recognition){ recognition.stop(); }
    }

    /* ---------- Pomodoro ---------- */
    let timer, timeLeft = 25 * 60; // 25 minutes
    function updateTimerUI(){
      const m = Math.floor(timeLeft/60), s = timeLeft%60;
      document.getElementById("timer").innerText = `${m}:${s<10?"0"+s:s}`;
      document.getElementById("progress").style.transform =
        `rotate(${(1500-timeLeft)/1500 * 360}deg)`;
    }
    function startTimer(){
      clearInterval(timer);
      timer = setInterval(()=>{
        if(timeLeft>0){
          timeLeft--; updateTimerUI();
        }else{
          clearInterval(timer);
          alert("‚è∞ Pomodoro finished! Take a short break.");
          logPomodoro();
          resetTimer(false); // keep progress ring reset but don't alert again
        }
      },1000);
    }
    function resetTimer(notify=true){
      clearInterval(timer);
      timeLeft = 25*60;
      updateTimerUI();
      if(notify){ /* noop */ }
    }
    function logPomodoro(){
      const data = getData(), t = todayStr();
      if(!data[t]) data[t] = {};
      data[t].pomodoros = (data[t].pomodoros || 0) + 1;
      setData(data);
      document.getElementById("pomoCount").innerText = data[t].pomodoros;
      renderCalendar();
    }

    /* ---------- Motivation (daily, calm fade) ---------- */
    const quotes = [
      "Breathe. Relax. Continue.",
      "Small steps create big changes.",
      "You are enough. Keep going.",
      "Stay calm. Stay focused.",
      "Your future self is proud of you."
    ];
    function setDailyQuote(){
      const day = new Date().getDate();
      document.getElementById("quote").innerText = quotes[day % quotes.length];
    }

    /* ---------- Calendar ---------- */
    function renderCalendar(){
      const cal = document.getElementById("calendar");
      cal.innerHTML = "";
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth();
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month+1, 0).getDate();
      const data = getData();

      // pad empty cells
      for(let i=0;i<firstDay;i++) cal.appendChild(document.createElement("div"));

      for(let d=1; d<=daysInMonth; d++){
        const cell = document.createElement("div");
        cell.className = "day";
        const dateStr = new Date(year, month, d).toISOString().split('T')[0];

        let inner = `<strong>${d}</strong>`;
        if(data[dateStr]){
          const obj = data[dateStr];
          if(obj.goal)      inner += "<div>üìå</div>";
          if(obj.voice)     inner += "<div>üé§</div>";
          if(obj.pomodoros) inner += `<div>üçÖ${obj.pomodoros}</div>`;
          if(obj.mood)      inner += `<div>${obj.mood}</div>`;
        }
        cell.innerHTML = inner;

        if(dateStr === todayStr()) cell.classList.add("highlight");

        // click to preview that day's saved note & goal
        cell.style.cursor = "pointer";
        cell.title = "Tap to view this day";
        cell.onclick = ()=>{
          const all = getData();
          const rec = all[dateStr] || {};
          const parts = [];
          if(rec.goal) parts.push("üéØ Goal: " + rec.goal);
          if(rec.journal) parts.push("üìì Journal: " + rec.journal);
          if(rec.voice) parts.push("üé§ Voice: " + rec.voice);
          if(rec.mood) parts.push("üòä Mood: " + rec.mood);
          if(rec.pomodoros) parts.push("‚è≥ Pomodoros: " + rec.pomodoros);
          alert(parts.length ? parts.join("\n\n") : "No entries for this day.");
        };

        cal.appendChild(cell);
      }
    }

    /* ---------- Load Today ---------- */
    function loadToday(){
      const data = getData(), t = todayStr();
      if(data[t]){
        if(data[t].goal) document.getElementById("savedGoal").innerText = "‚úÖ " + data[t].goal;
        if(data[t].journal) document.getElementById("savedJournal").innerText = "üìå Loaded your journal for today.";
        if(data[t].voice) document.getElementById("savedVoice").innerText = "Today‚Äôs note: " + data[t].voice;
        if(data[t].mood) document.getElementById("emojiMood").innerText = data[t].mood;
        if(data[t].pomodoros) document.getElementById("pomoCount").innerText = data[t].pomodoros;
      }
      // Pre-fill inputs
      document.getElementById("dailyGoal").value = (data[t]?.goal) || "";
      document.getElementById("journalEntry").value = (data[t]?.journal) || "";
    }

    /* ---------- Init ---------- */
    setDailyQuote();
    loadToday();
    renderCalendar();
    updateTimerUI();
  </script>
</body>
</html>
